package com.sdase.malware.scanner;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Main {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(
                new InputStreamReader(System.in));

        // Reading data from user
        System.out.println("Enter name:");
        String key = reader.readLine();
        System.out.println("Enter url:");
        String value = reader.readLine();
        System.out.println("Enter Topic Name:");
        String topicName = reader.readLine();

        startProducer(topicName,key,value);
        startConsumer(topicName);
    }


    public static void startProducer(String topicName,String key, String value){
          Producer producer = new Producer();
          System.out.println("Starting Producer");
          producer.sendMessage(topicName,key,value);
    }

    public static void startConsumer(String topicName) throws IOException {
        Consumer consumer = new Consumer();
        System.out.println("Starting Consumer");
        consumer.recieveMessage(topicName);
    }
}
