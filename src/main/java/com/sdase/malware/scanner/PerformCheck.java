package com.sdase.malware.scanner;


import com.sdase.malware.scanner.streaming.model.CheckResultEvent;

import java.util.*;
import java.util.HashSet;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class PerformCheck {
    CheckResultEvent checkResultEvent = new CheckResultEvent();
    private String TextDocument;
    private static  String IBAN ;

    public PerformCheck() {
    }

    public PerformCheck(String textDocument) {
        TextDocument = textDocument;
    }

    //IBAN check
    public void checkIBAN() {

        ArrayList<String> blackListIBAN = new ArrayList<String>();
        blackListIBAN.add("DE15 3006 0601 0505 7807 80 ");
        blackListIBAN.add("DE13 3007 1601 4505 7807 90");
        blackListIBAN.add("DE11 4008 2601 3505 7807 60");
        blackListIBAN.add("DE12 1009 3601 2505 7807 70");
        blackListIBAN.add("DE17 2006 4601 1505 7807 50");
        blackListIBAN.add("DE19 3006 0601 0505 7807 40");

        Pattern pattern = Pattern.compile("[a-zA-Z]+([0-9]+( [0-9]+)+) ");
        Matcher matcher = pattern.matcher(TextDocument);
        matcher.find();
        IBAN =  matcher.group();

        System.out.println(IBAN);

        if (blackListIBAN.contains(IBAN)) {
            checkResultEvent.setState(CheckResultEvent.StateEnum.SUSPICIOUS);
            checkResultEvent.setName("IBAN check");
            checkResultEvent.setDetails("IBAN found in list of Blacklisted IBAN's");
        } else {
            checkResultEvent.setState(CheckResultEvent.StateEnum.OK);
            checkResultEvent.setName("IBAN check");
            checkResultEvent.setDetails("IBAN not found in list of Blacklisted IBAN's");
        }
        System.out.println(checkResultEvent);
    }

}